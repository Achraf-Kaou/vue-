<script setup lang="ts">
import { Ban, Eye } from 'lucide-vue-next'

// Define the props with TypeScript types
interface Props {
  data: {
    sha256: string
  }
}

const props = defineProps<Props>()

// Define the malware lookup services
const lookupServices = [
  {
    name: 'VirusTotal Report',
    url: (sha256: string) => `https://www.virustotal.com/gui/file/${sha256}`,
    colorClass: 'text-red-500 hover:text-red-700',
  },
  {
    name: 'Triage Report',
    url: (sha256: string) => `https://tria.ge/s?q=${sha256}`,
    colorClass: 'text-yellow-500 hover:text-yellow-700',
  },
  {
    name: 'MetaDefender Report',
    url: (sha256: string) => `https://metadefender.com/results/hash/${sha256}`,
    colorClass: 'text-blue-500 hover:text-blue-700',
  },
  {
    name: 'Hybrid Analysis Report',
    url: (sha256: string) => `https://www.hybrid-analysis.com/search?query=${sha256}`,
    colorClass: 'text-green-500 hover:text-green-700',
  },
]
</script>

<template>
  <section class="px-4 py-6">
    <div class="w-full bg-white rounded-lg shadow-md">
      <div class="p-6">
        <h2 class="text-xl font-bold mb-4 flex items-center">
          <Ban class="mr-2" size="20" />
          MALWARE LOOKUP
        </h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
          <div
            v-for="(service, index) in lookupServices"
            :key="index"
            class="flex flex-col items-center p-3 border-r border-gray-200 last:border-r-0"
          >
            <a
              :href="service.url(props.data.sha256)"
              target="_blank"
              rel="noopener noreferrer"
              :class="['flex items-center font-medium', service.colorClass]"
            >
              <Eye class="mr-1" size="16" />
              {{ service.name }}
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
</template>
